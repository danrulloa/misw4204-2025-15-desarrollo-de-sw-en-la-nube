# ---------------------------------------
# prometheus/prometheus.yml
# ---------------------------------------
# Scrapea a sí mismo y a exporters/servicios que expongan /metrics.
# Agrega aquí tus targets (API, workers) cuando instrumentes con prometheus_client.

# Prometheus config
---
global:
  scrape_interval: 10s
  evaluation_interval: 30s

scrape_configs:
  - job_name: prometheus
    static_configs:
      - targets: ['${OBS_IP}:9090']

  - job_name: nginx
    static_configs:
      - targets: ['${WEB_IP}:9113']

  - job_name: rabbitmq
    static_configs:
      - targets: ['${MQ_IP}:15692']

  - job_name: postgres_auth
    static_configs:
      - targets: ['${DB_IP}:9187']

  - job_name: postgres_core
    static_configs:
      - targets: ['${DB_IP}:9188']

  - job_name: cadvisor
    static_configs:
      - targets:
        - "${WEB_IP}:8080"
        - "${CORE_IP}:8080"
        - "${DB_IP}:8080"
        - "${MQ_IP}:8080"
        - "${WORKER_IP}:8080"

  - job_name: "api-auth"
    metrics_path: /auth/metrics
    static_configs:
      - targets: ["${CORE_IP}:8001"]

  - job_name: "api-core"
    metrics_path: /metrics
    static_configs:
      - targets: ["${CORE_IP}:8000"]

